# CHARI å‰ç«¯é–‹ç™¼è¦æ ¼æ›¸ (Phase 1: Client App)

> çµ¦ Gemini çš„é–‹ç™¼æŒ‡å¼• - å°ˆæ³¨é†«å¸«ç«¯ SMART App

---

## å°ˆæ¡ˆæ¦‚è¿°

**CHARI** (Cross-Hospital Admission Record Integration) æ˜¯ä¸€å€‹ SMART on FHIR Appï¼Œç”¨æ–¼è·¨é™¢ç—…æ‘˜äº¤æ›ã€‚

| é …ç›® | èªªæ˜ |
|------|------|
| éƒ¨ç½²æ–¹å¼ | GitHub Pagesï¼ˆç´”å‰ç«¯ï¼Œç„¡å¾Œç«¯ï¼‰ |
| èªè­‰æ–¹å¼ | OAuth 2.0ï¼ˆSMART App Launchï¼‰ |
| è³‡æ–™ä¾†æº | è¡›ç¦éƒ¨ FHIR Server |
| FHIR ç‰ˆæœ¬ | R4 |

---

## ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Aé†«é™¢ (è½‰å‡ºç«¯)                                                      â”‚
â”‚  é†«å¸«å®Œæˆç—…æ‘˜ â†’ å•Ÿå‹• CHARI â†’ é è¦½ â†’ ä¸Šå‚³ç—…æ‘˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ POST Bundle
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     è¡›ç¦éƒ¨ FHIR Server      â”‚
                    â”‚  thas.mohw.gov.tw/v/r4/fhir â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ GET Composition
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Bé†«é™¢ (æ¥æ”¶ç«¯)                                                      â”‚
â”‚  ç—…äººå ±åˆ° â†’ å•Ÿå‹• CHARI â†’ æŸ¥è©¢å¤–é™¢ç—…æ‘˜ â†’ å¯©æ ¸ â†’ å‹¾é¸ â†’ å°å…¥æœ¬é™¢         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€è¡“æ£§

| é …ç›® | é¸æ“‡ |
|------|------|
| æ¡†æ¶ | React 18+ |
| FHIR å®¢æˆ¶ç«¯ | fhirclient.js |
| UI å…ƒä»¶ | Tailwind CSSï¼ˆå»ºè­°ï¼‰ |
| å»ºç½®å·¥å…· | Vite |
| éƒ¨ç½² | GitHub Pages |

---

## Phase 1 åŠŸèƒ½ç¯„åœ

### å››å¤§æ¨¡çµ„

| æ¨¡çµ„ | åŠŸèƒ½ | ä½¿ç”¨è€… |
|------|------|--------|
| **å¤–é™¢ç—…æ‘˜æŸ¥è©¢** | æœå°‹ä¸¦é¡¯ç¤ºå¤–é™¢ç—…æ‘˜æ¸…å–® | æ¥æ”¶ç«¯é†«å¸« |
| **ç—…æ‘˜å…§å®¹å¯©æ ¸** | æª¢è¦–ç—…æ‘˜å…§å®¹ï¼Œé¸æ“‡å°å…¥é …ç›® | æ¥æ”¶ç«¯é†«å¸« |
| **ä½é™¢ç—…æ­·å°å…¥** | å°‡é¸å–é …ç›®å¯«å…¥æœ¬é™¢ç³»çµ± | æ¥æ”¶ç«¯é†«å¸« |
| **ç—…æ‘˜ä¸Šå‚³** | å°‡æœ¬é™¢ç—…æ‘˜ä¸Šå‚³è‡³ FHIR Server | è½‰å‡ºç«¯é†«å¸« |

---

## SMART on FHIR Launch

### æª”æ¡ˆçµæ§‹

```
client/
â”œâ”€â”€ launch.html      # SMART Launch é€²å…¥é»
â”œâ”€â”€ app.html         # ä¸»æ‡‰ç”¨ç¨‹å¼ï¼ˆReact æ›è¼‰ï¼‰
â””â”€â”€ assets/
    â””â”€â”€ ...
```

### launch.html

```html
<!DOCTYPE html>
<html>
<head>
  <title>CHARI Launch</title>
  <script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.min.js"></script>
</head>
<body>
  <script>
    FHIR.oauth2.authorize({
      clientId: "chari-app",
      scope: "launch openid fhirUser patient/*.read patient/*.write",
      redirectUri: "app.html"
    });
  </script>
</body>
</html>
```

### app.html åˆå§‹åŒ–

```javascript
import FHIR from 'fhirclient';

FHIR.oauth2.ready().then(client => {
  // client å¯ç”¨æ–¼æ‰€æœ‰ FHIR æ“ä½œ
  window.fhirClient = client;
});
```

---

## æ¨¡çµ„ä¸€ï¼šå¤–é™¢ç—…æ‘˜æŸ¥è©¢

### åŠŸèƒ½

1. è¼¸å…¥ç—…äººèº«åˆ†è­‰æˆ–å¥ä¿å¡è™Ÿ
2. é¡¯ç¤ºç—…äººåŸºæœ¬è³‡æ–™ï¼ˆç¢ºèªèº«åˆ†ï¼‰
3. æŸ¥è©¢è©²ç—…äººçš„å¤–é™¢ç—…æ‘˜
4. ä»¥å¡ç‰‡æ¸…å–®é¡¯ç¤ºï¼šä¾†æºé†«é™¢ã€æ—¥æœŸã€è¨ºæ–·æ‘˜è¦

### FHIR æŸ¥è©¢

```javascript
// ç”¨èº«åˆ†è­‰æŸ¥ç—…äºº
const patients = await client.request(
  `Patient?identifier=urn:oid:2.16.886.103|${idNumber}`
);

// ç”¨å¥ä¿å¡æŸ¥ç—…äºº
const patients = await client.request(
  `Patient?identifier=urn:oid:2.16.886.101.100|${nhiNumber}`
);

// æŸ¥è©¢ç—…äººçš„å‡ºé™¢ç—…æ‘˜
const compositions = await client.request(
  `Composition?subject=Patient/${patientId}&type=http://loinc.org|18842-5&_sort=-date`
);
```

### UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” å¤–é™¢ç—…æ‘˜æŸ¥è©¢                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èº«åˆ†è­‰/å¥ä¿å¡: [____________] [æŸ¥è©¢]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘¤ ç‹å¤§æ˜ï½œç”·ï½œ65æ­²                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‰¾åˆ° 2 ç­†å¤–é™¢ç—…æ‘˜                        â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¥ è‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢                    â”‚ â”‚
â”‚ â”‚ ğŸ“… 2025-01-15                       â”‚ â”‚
â”‚ â”‚ ğŸ“‹ æ€¥æ€§å¿ƒè‚Œæ¢—å¡                      â”‚ â”‚
â”‚ â”‚                          [æª¢è¦–] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¥ åœ‹ç«‹è‡ºç£å¤§å­¸é†«å­¸é™¢é™„è¨­é†«é™¢         â”‚ â”‚
â”‚ â”‚ ğŸ“… 2024-08-20                       â”‚ â”‚
â”‚ â”‚ ğŸ“‹ è‚ºç‚                             â”‚ â”‚
â”‚ â”‚                          [æª¢è¦–] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡çµ„äºŒï¼šç—…æ‘˜å…§å®¹å¯©æ ¸

### åŠŸèƒ½

1. å·¦å´é¡¯ç¤ºæ®µè½æ¸…å–®ï¼ˆå¯å‹¾é¸ï¼‰
2. å³å´é¡¯ç¤ºé¸ä¸­æ®µè½çš„è©³ç´°å…§å®¹
3. æ¯å€‹æ®µè½å¯å±•é–‹æŸ¥çœ‹çµæ§‹åŒ–è³‡æ–™
4. ä½¿ç”¨è€…å‹¾é¸è¦å°å…¥çš„é …ç›®

### Composition æ®µè½è§£æ

| æ®µè½ | LOINC Code | å°æ‡‰ Resource |
|------|------------|---------------|
| ä¸»è¨´ | 10154-3 | (ç´”æ–‡å­—) |
| ç¾ç—…å² | 10164-2 | (ç´”æ–‡å­—) |
| éå»ç—…å² | 11348-0 | Condition |
| ä½é™¢ç¶“é | 8648-8 | Procedure |
| å‡ºé™¢è¨ºæ–· | 11535-2 | Condition |
| å‡ºé™¢ç”¨è—¥ | 10183-2 | MedicationStatement |
| éæ•å² | 48765-2 | AllergyIntolerance |
| å‡ºé™¢è¨ˆç•« | 18776-5 | CarePlan |

### è§£æç¯„ä¾‹

```javascript
// è§£æ Composition æ®µè½
composition.section.forEach(section => {
  const code = section.code?.coding?.[0]?.code;
  const title = section.title;
  const text = section.text?.div;           // æ•˜è¿°æ–‡å­—
  const entries = section.entry || [];       // çµæ§‹åŒ–è³‡æ–™ references

  // å–å¾—çµæ§‹åŒ–è³‡æ–™
  for (const entry of entries) {
    const resource = await client.request(entry.reference);
    // resource å¯èƒ½æ˜¯ Condition, MedicationStatement ç­‰
  }
});
```

### é‡è¦æ¬„ä½

```javascript
// ä¾†æºé†«é™¢
composition.custodian?.display  // "è‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢"

// ç—…æ‘˜æ—¥æœŸ
composition.date  // "2025-01-15"

// é—œè¯ä½é™¢
composition.encounter?.reference  // "Encounter/enc-001"
```

### UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† è¿”å›                     ç—…æ‘˜å¯©æ ¸                              â”‚
â”‚ ä¾†æºï¼šè‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢ï½œ2025-01-15                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ®µè½é¸æ“‡           â”‚  ã€å‡ºé™¢è¨ºæ–·ã€‘                               â”‚
â”‚                    â”‚                                            â”‚
â”‚ â˜ ä¸»è¨´             â”‚  åŸå§‹å…§å®¹ï¼š                                 â”‚
â”‚ â˜ ç¾ç—…å²           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â˜ ä½é™¢ç¶“é         â”‚  â”‚ 1. æ€¥æ€§å¿ƒè‚Œæ¢—å¡                     â”‚   â”‚
â”‚ â˜‘ å‡ºé™¢è¨ºæ–· â†       â”‚  â”‚ 2. é«˜è¡€å£“                          â”‚   â”‚
â”‚ â˜‘ å‡ºé™¢ç”¨è—¥         â”‚  â”‚ 3. ç¬¬äºŒå‹ç³–å°¿ç—…                     â”‚   â”‚
â”‚ â˜‘ éæ•å²           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â˜ å‡ºé™¢è¨ˆç•«         â”‚                                            â”‚
â”‚                    â”‚  å¯å°å…¥é …ç›®ï¼š                               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â˜‘ æ€¥æ€§å¿ƒè‚Œæ¢—å¡ [I21.9]                    â”‚
â”‚ â˜‘ = å°‡å°å…¥         â”‚  â˜‘ é«˜è¡€å£“ [I10]                            â”‚
â”‚                    â”‚  â˜‘ ç¬¬äºŒå‹ç³–å°¿ç—… [E11.9]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              [â† ä¸Šä¸€æ®µ] [ä¸‹ä¸€æ®µ â†’] [ç¢ºèªå°å…¥]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡çµ„ä¸‰ï¼šä½é™¢ç—…æ­·å°å…¥

### åŠŸèƒ½

1. é¡¯ç¤ºå³å°‡å°å…¥çš„é …ç›®æ‘˜è¦
2. ä½¿ç”¨è€…ç¢ºèªå¾ŒåŸ·è¡Œ POST
3. è¨˜éŒ„è³‡æ–™ä¾†æºä»¥ä¾›è¿½æº¯

### å°å…¥è³‡æºçµæ§‹

å°å…¥çš„è³‡æºéœ€è¨˜éŒ„ä¾†æºï¼š

```javascript
const condition = {
  resourceType: "Condition",
  meta: {
    source: `https://thas.mohw.gov.tw/v/r4/fhir/Composition/${sourceCompositionId}`
  },
  clinicalStatus: {
    coding: [{
      system: "http://terminology.hl7.org/CodeSystem/condition-clinical",
      code: "active"
    }]
  },
  code: {
    coding: [{
      system: "http://hl7.org/fhir/sid/icd-10-cm",
      code: "I21.9",
      display: "Acute myocardial infarction, unspecified"
    }],
    text: "æ€¥æ€§å¿ƒè‚Œæ¢—å¡"
  },
  subject: { reference: `Patient/${patientId}` }
};

// POST åˆ° FHIR Server
await client.create(condition);
```

### UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ç¢ºèªå°å…¥è‡³ä½é™¢ç—…æ­·                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ğŸ“‹ è¨ºæ–· (3é …)                           â”‚
â”‚   â€¢ æ€¥æ€§å¿ƒè‚Œæ¢—å¡ [I21.9]                â”‚
â”‚   â€¢ é«˜è¡€å£“ [I10]                        â”‚
â”‚   â€¢ ç¬¬äºŒå‹ç³–å°¿ç—… [E11.9]                â”‚
â”‚                                         â”‚
â”‚ ğŸ’Š ç”¨è—¥ (4é …)                           â”‚
â”‚   â€¢ Aspirin 100mg QD                   â”‚
â”‚   â€¢ Clopidogrel 75mg QD                â”‚
â”‚   â€¢ Atorvastatin 40mg HS               â”‚
â”‚   â€¢ Metformin 500mg BID                â”‚
â”‚                                         â”‚
â”‚ âš ï¸ éæ• (1é …)                           â”‚
â”‚   â€¢ Penicillinï¼ˆçš®ç–¹ï¼‰                  â”‚
â”‚                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ ğŸ“ ä¾†æºï¼šè‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢ (2025-01-15)     â”‚
â”‚                                         â”‚
â”‚         [å–æ¶ˆ]          [ç¢ºèªå°å…¥]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡çµ„å››ï¼šç—…æ‘˜ä¸Šå‚³

### åŠŸèƒ½

1. é¸æ“‡æ–‡ä»¶é¡å‹ï¼ˆå‡ºé™¢ç—…æ‘˜/è½‰é™¢ç—…æ‘˜ï¼‰
2. é è¦½å°‡ä¸Šå‚³çš„å…§å®¹
3. ç¢ºèªå¾ŒåŸ·è¡Œ Bundle POST

### Document Bundle çµæ§‹

```javascript
const bundle = {
  resourceType: "Bundle",
  type: "document",
  timestamp: new Date().toISOString(),
  entry: [
    {
      fullUrl: "urn:uuid:composition-1",
      resource: composition  // Composition
    },
    {
      fullUrl: "urn:uuid:patient-1",
      resource: patient      // Patient
    },
    {
      fullUrl: "urn:uuid:condition-1",
      resource: condition    // Condition (è¨ºæ–·)
    },
    // ... å…¶ä»–è³‡æº
  ]
};

// POST Bundle
await client.request({
  url: "Bundle",
  method: "POST",
  body: JSON.stringify(bundle),
  headers: { "Content-Type": "application/fhir+json" }
});
```

### UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ä¸Šå‚³ç—…æ‘˜                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘¤ æç¾è¯ï½œå¥³ï½œ45æ­²                      â”‚
â”‚                                         â”‚
â”‚ æ–‡ä»¶é¡å‹ï¼š                               â”‚
â”‚ â—‹ å‡ºé™¢ç—…æ‘˜                              â”‚
â”‚ â— è½‰é™¢ç—…æ‘˜                              â”‚
â”‚                                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ ç—…æ‘˜é è¦½ï¼š                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“‹ è½‰é™¢è¨ºæ–·ï¼šæ€¥æ€§ä¸»å‹•è„ˆå‰é›¢           â”‚ â”‚
â”‚ â”‚ ğŸ“ ä½é™¢ç¶“éï¼šICU 2å¤©                 â”‚ â”‚
â”‚ â”‚ ğŸ’Š ç›®å‰ç”¨è—¥ï¼š5 é …                    â”‚ â”‚
â”‚ â”‚ âš ï¸ éæ•å²ï¼šç„¡å·²çŸ¥éæ•                â”‚ â”‚
â”‚ â”‚ ğŸ¥ è½‰é™¢åŸå› ï¼šéœ€ç·Šæ€¥é–‹å¿ƒæ‰‹è¡“          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â˜ï¸ ä¸Šå‚³ç›®æ¨™ï¼šè¡›ç¦éƒ¨ FHIR Server          â”‚
â”‚                                         â”‚
â”‚       [è¿”å›ç·¨è¼¯]        [ç¢ºèªä¸Šå‚³]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¸¬è©¦è³‡æ–™

æ²™ç›’å·²æœ‰ 10 ç­†æ¸¬è©¦ç—…æ‘˜ï¼š

| ç—…äºº | èº«åˆ†è­‰ | è¨ºæ–· | ä¾†æºé†«é™¢ |
|------|--------|------|----------|
| ç‹å¤§æ˜ | A123456789 | æ€¥æ€§å¿ƒè‚Œæ¢—å¡ | è‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢ |
| æç¾è¯ | A223456789 | è…¦ä¸­é¢¨ | è‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢ |
| å¼µå¿—å¼· | A323456789 | è‚ºç‚ | è‡ºåŒ—æ¦®æ°‘ç¸½é†«é™¢ |
| é»ƒé›…çª | A623456789 | ä¹³ç™Œè¡“å¾Œ | å°å¤§é†«é™¢ |
| å‘¨ç§€è˜­ | A823456789 | è†½å›Šåˆ‡é™¤ | é•·åºšé†«é™¢ |

**æ¸¬è©¦æŸ¥è©¢**ï¼š
```
GET /Patient?identifier=urn:oid:2.16.886.103|A123456789
GET /Composition?subject=Patient/pt-test-001
```

---

## æª”æ¡ˆçµæ§‹

```
CHARI/
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ launch.html          # SMART Launch
â”‚   â”œâ”€â”€ app.html             # React æ›è¼‰é»
â”‚   â”œâ”€â”€ index.html           # é–‹ç™¼ç”¨ï¼ˆViteï¼‰
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main.jsx
â”‚       â”œâ”€â”€ App.jsx
â”‚       â”œâ”€â”€ hooks/
â”‚       â”‚   â””â”€â”€ useFhirClient.js
â”‚       â”œâ”€â”€ services/
â”‚       â”‚   â””â”€â”€ fhirQueries.js
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ PatientSearch.jsx
â”‚       â”‚   â”œâ”€â”€ CompositionList.jsx
â”‚       â”‚   â”œâ”€â”€ CompositionDetail.jsx
â”‚       â”‚   â”œâ”€â”€ ImportConfirm.jsx
â”‚       â”‚   â”œâ”€â”€ UploadForm.jsx
â”‚       â”‚   â””â”€â”€ sections/
â”‚       â”‚       â”œâ”€â”€ DiagnosisList.jsx
â”‚       â”‚       â”œâ”€â”€ MedicationList.jsx
â”‚       â”‚       â””â”€â”€ AllergyList.jsx
â”‚       â””â”€â”€ styles/
â”‚           â””â”€â”€ index.css
â”œâ”€â”€ test-data/               # æ¸¬è©¦è³‡æ–™ï¼ˆå·²æœ‰ï¼‰
â”œâ”€â”€ README.md
â””â”€â”€ LICENSE
```

---

## UI è¨­è¨ˆè¦é»

### è‰²å½©

| ç”¨é€” | è‰²ç¢¼ |
|------|------|
| ä¸»è‰²ï¼ˆæŸ¥è©¢/å°å…¥ï¼‰ | #0066CC (Medical Blue) |
| è¼”è‰²ï¼ˆä¸Šå‚³ï¼‰ | #28A745 (Medical Green) |
| è­¦ç¤ºï¼ˆéæ•ï¼‰ | #DC3545 (Red) |
| èƒŒæ™¯ | #FFFFFF, #F5F5F5 |

### é‡è¦æé†’

- éæ•å²ç”¨ç´…è‰²é†’ç›®æ¨™ç¤º
- ä¾†æºé†«é™¢ç”¨è‰²å¡Šå€åˆ†
- å°å…¥é …ç›®éœ€æœ‰å‹¾é¸ç¢ºèª
- éŒ¯èª¤è¨Šæ¯å‹å–„æç¤º

---

## æ³¨æ„äº‹é …

1. **CORS**ï¼šFHIR Server å·²è¨­å®šå…è¨±è·¨åŸŸ
2. **Token**ï¼šfhirclient.js è‡ªå‹•è™•ç†
3. **GitHub Pages**ï¼šVite è¨­å®š `base: '/CHARI/client/'`
4. **Sandbox URL**ï¼š`https://thas.mohw.gov.tw/v/r4/fhir`

---

## é–‹ç™¼é †åºå»ºè­°

1. âœ… launch.html + SMART èªè­‰
2. âœ… ç—…äººæœå°‹ï¼ˆæ¸¬è©¦èº«åˆ†è­‰é©—è­‰ï¼‰
3. âœ… ç—…æ‘˜åˆ—è¡¨
4. âœ… ç—…æ‘˜å¯©æ ¸é é¢
5. âœ… å°å…¥ç¢ºèªåŠŸèƒ½
6. âœ… ä¸Šå‚³åŠŸèƒ½
7. âœ… UI ç¾åŒ–
8. âœ… GitHub Pages éƒ¨ç½²

---

## åƒè€ƒè³‡æº

- [fhirclient.js](https://docs.smarthealthit.org/client-js/)
- [SMART App Launch](https://docs.smarthealthit.org/)
- [TW Core IG](https://twcore.mohw.gov.tw/)
- [FHIR R4 Composition](https://hl7.org/fhir/R4/composition.html)
